<%= javascript_include_tag "annotations" %>
<%= javascript_include_tag "diff_viewer" %>
<script type="text/javascript">
  setActiveFilePos(currentHeaderPos)
  initializeAnnotationsForCode();
  attachEvents();
  attachChangeFileEvents();
  attachAnnotationPaneEvents();
  drawDiffViewer();
</script>

<script>
  var newFile = {};
  newFile.url = '<%= url_for(params.permit(:header_position, :action, :controller).to_h) %>'

  <% if @is_pdf %>
  newFile.pdf = true;
  newFile.pdfUrl = "<%= url_for download_course_assessment_submission_path(@course, @assessment, @submission, header_position: @header_position) %>";
  newFile.annotatedPdfUrl = "<%= url_for download_course_assessment_submission_path(@course, @assessment, @submission, @header_position, annotated: true) %>";
  newFile.previewMode = false;
  <% if @preview_mode %>
      newFile.previewMode = true;
  <% end %>
  <% else %>
  newFile.pdf = false;
  <% end %>
</script>
